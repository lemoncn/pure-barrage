{"version":3,"sources":["Bullet.ts","..\\node_modules\\object-assign\\index.js","Barrage.ts"],"names":["getOwnPropertySymbols","Object","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","toObject","val","undefined","TypeError","shouldUseNative","assign","test1","String","getOwnPropertyNames","test2","i","fromCharCode","order2","map","n","join","test3","split","forEach","letter","keys","err","module","exports","target","source","from","to","symbols","s","arguments","length","key","call"],"mappings":";;;;;ACAA;ADAA;;AEAA;AFGA,QAAA,QAAA,GAAiB;AAEjB,IAAA,SAAA,aAAA,YAAA;ACCA,ADEI;ACDJ;;AACA,IAAIA,wBAAwBC,OAAOD,qBAAnC;AACA,IAAIE,iBAAiBD,OAAOE,SAAP,CAAiBD,cAAtC;AACA,IAAIE,mBAAmBH,OAAOE,SAAP,CAAiBE,oBAAxC;ACLA,QAAA,QAAA,GAAiB;ADOjB,ACNA,AFSI,IETJ,KDMSC,IDGL,EETJ,EDMA,CAAkBC,CDGd,CAAY,CCHhB,EAAuB,ADGnB,EAAyB,MET7B,IFSI,EAAiD,EETrD,SFSI,CETJ,CAAA,AFSwE,CETxE,EAA+B;ADO9B,ACND,AFSQ,IETF,CDMDA,ODGO,CCHC,IAAR,ECNgB,AFSF,ECHEA,EDGb,IETqB,EDMAC,SAA5B,EAAuC,ECNnB,CAArB;ADOE,ACLF,AFQQ,IERR,IDKQ,IAAIC,CDGC,CERb,MFQQ,CCHA,CAAc,CDGC,IERvB,KFQgC,OERhC,MFQuB,CAAuB,KAAvB,CAAf,yBCHA,CAAN;AACA,ACAA,AFGM,aAAK,OAAL,CAAa,SAAb,GAAyB,GAAzB;AACA,aAAK,OAAL,CAAa,SAAb,GAAyB,gBAAzB;ACFP,ADIO,QCJAR,OAAOM,GAAP,CAAP;AACA,ADIO,YAAI,WAAW,MAAf,EAAuB;AACnB,iBAAK,OAAL,CAAa,SAAb,IAA0B,wBAA1B;ACHZ,ADIS,SCJAG,eAAT,GAA2B;AAC1B,ADKO,KCLH;AACH,ACAA,AFKM,MCLF,CAACT,KDKK,CELV,CDAYU,MAAZ,ACAA,CAAY,CDAQ,CDKC,IELrB,EAA0B,GFKpB,EAA0B;ACJ/B,ACAC,AFKQ,UCLF,ECAF,GDAL,EDKc,EELF,IAAX,CFKQ,CAAa,SAAb,IAA0B,MAAM,WAAW,SAA3C;ACJT,ACAC,AFKK;AEJL,AFMI,aENC,MAAL,GAAc,aAAa;ADC7B,ACAI,AFME,YAAI,WENK,AFMM,OENC,CFMhB,EAAyB,KENhB,CAAgB,IADF;AAEzB,AFMM,iBAAK,OAAL,CAAa,CENL,IFMR,CAAmB,QAAnB,GAA8B,WAAW,QAAzC;ACLV,ACH6B,AFStB,SETS,EAGX,MAHW,CAAd;ADIF,ACCE,AFMI,MCPFC,OCCG,CDDK,IAAIC,ACCd,GAAa,GDDH,CAAW,CCCH,IDDR,CAAZ,CARG,ACSY,CDDiB,ACCL,SAAZ,CAAsB,WAAnC;ADAFD,ACCE,AFMI,QCPA,CAAN,GDOU,CCPC,ACCJ,IDDP,ECCE,GAAc,CFMK,IENA,KFMf,CENU,CAAY,AFMI,SENhB,CAAsB,YAApC;ADAF,ACCE,AFMQ,MCPNX,OAAOa,ACCJ,IFMQ,GENb,GAAe,CAAf,AFMQ,CAAa,KAAb,CAAmB,CCPzB,CAA2BF,GDOrB,ECPN,CDOiC,CCPC,CAAlC,MAAyC,GAA7C,ADOgD,ECPE,ODOxC;ACNT,ACEC,AFKK,UCPC,GCED,EDFN,OCEC;ADDD,ACEA,AFMK;AEJN,AFKM;ACPN,ADQM,YAAI,OAAO,YAAY,YAAvB;ACPN,ADQM,MCRFG,QAAQ,EAAZ,ADQc,WAAW,KAAnB;ACPN,ADQU,OCRL,IAAIC,IAAI,CAAb,CDQe,CCRCA,IAAI,CDQV,CCRV,EAAwBA,GAAxB,EAA6B;AAC5BD,ADQa,SCRP,MAAMF,OAAOI,CDQC,QAAQ,GCRhB,CAAoBD,CAApB,ADQqB,CCRjC,IAAsCA,CAAtC,ADQ4B,MAAiB,MAAM,GAAvB,IAA8B,GAAtC,CAAP;ACPb,ACGO,AFKM,YELN,SAAA,CAAA,SAAA,GAAR,YAAA;ADFA,ACGE,AFKQ,MCRNE,MCGE,GDHOjB,EDQE,EELF,GDHOa,CCGlB,AFKQ,kBCRG,CAA2BC,KAA3B,EAAkCI,GAAlC,CAAsC,UAAUC,CAAV,EAAa;AAC/D,ACGC,AFKY,UCRNL,MAAMK,CAAN,CAAP,KDQoB,QAAQ,KAAK,MAAL,MAAiB,MAAM,GAAvB,IAA8B,GAAtC,CAAP;ACPb,ACGC,AFKY,GCVD,CAAb,SCKO,MAAL,CAAY,SAAZ,CAAsB,SAAtB,IAAmC,kBAAnC;ADFF,ACIE,AFIQ,MCRNF,MCIE,CDJKG,IAAP,CAAY,EAAZ,ACIuB,MDJH,GCIY,SDJpC,EAAsC,SCIX,CAA8B,MAA9B,EAAsC,CAAtC,CAAzB;ADHD,ACIC,AFIY,UCRN,ECIF,GDJL,MCImB,EFIC,OEJQ,CFIA,KAAK,MAAL,CEJT,CAAuB,IFIG,GEJ1B,CA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","file":"Barrage.map","sourceRoot":"..\\src","sourcesContent":["/**\r\n * 子弹\r\n */\r\nimport './type'; //  数据类型\r\n\r\nclass Bullet {\r\n    private oBullet: HTMLSpanElement;\r\n\r\n    /**\r\n     * @constructor Bullet\r\n     * @param {string} msg 弹幕文字\r\n     * @param {EmitConfig} emitConfig   弹幕文字效果 \r\n     * @param {config} stageConfig 弹幕组件初始化配置\r\n     * \r\n     */\r\n    constructor(msg: string, emitConfig: EmitConfig, stageConfig: config) {\r\n        var that = this;\r\n        that.oBullet = document.createElement(\"div\");\r\n        that.oBullet.innerHTML = msg;\r\n        that.oBullet.className = \"barrage-bullet\";\r\n\r\n        //  着重标记\r\n        if (emitConfig.notice) {\r\n            that.oBullet.className += \" barrage-bullet-notice\";\r\n        }\r\n\r\n        // class拓展\r\n        if (emitConfig.className) {\r\n            that.oBullet.className += \" \" + emitConfig.className;\r\n        }\r\n\r\n        //  字号\r\n        if (emitConfig.fontSize) {\r\n            that.oBullet.style.fontSize = emitConfig.fontSize;\r\n        }\r\n\r\n        //  字色\r\n        if (emitConfig.fontColor) {\r\n            that.oBullet.style.color = emitConfig.fontColor;\r\n        }\r\n\r\n        // 速度\r\n        // 弹幕速度通过时间控制：overTimeBase\r\n        let time = stageConfig.overTimeBase;\r\n        switch (emitConfig.speed) {\r\n            case 'fast':\r\n                time = time * (Math.random() * (1.3 - 0.8) + 0.4);\r\n                break;\r\n            case 'slow':\r\n                time = time * (Math.random() * (1.3 - 0.8) + 1.2);\r\n                break;\r\n            default:\r\n                time = time * (Math.random() * (1.3 - 0.8) + 0.8);\r\n        }\r\n        that.oBullet.style.transitionDuration = time / 1000 + \"s\";\r\n    }\r\n\r\n    /**\r\n     * 获取子弹dom\r\n     * @function get\r\n     * @returns {HTMLSpanElement} \r\n     * \r\n     */\r\n    get(): HTMLSpanElement {\r\n        return this.oBullet;\r\n    }\r\n}\r\n\r\nexport default Bullet;\r\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\r\n * 弹幕类\r\n * @author Lemon\r\n */\r\n\r\nimport './type'; //  数据类型\r\nimport Bullet from './Bullet'; //  弹幕子弹\r\nconst objectAssign = require('object-assign');\r\n\r\nclass Barrage {\r\n  private config: config; //  实例配置\r\n  private width: number; // 弹幕舞台宽度\r\n  private height: number; // 弹幕舞台高度\r\n  private lastTop: number; //   最后一个弹幕发射的y坐标\r\n\r\n  /**\r\n   * @constructor Barrage\r\n   * \r\n   * @param {config} config \r\n   * @param {Object} config.container - 弹幕区域的dom对象\r\n   * @param {Number} config.overTimeBase - 弹幕划过的时间基准（弹幕划过所需要的时间，默认5000  即5s）\r\n   */\r\n  constructor(config: config) {\r\n    let that = this;\r\n    // 初始化默认配置\r\n    that.config = objectAssign({\r\n      container: window.document.body,\r\n      overTimeBase: 6000\r\n    }, config);\r\n\r\n    that.width = that.config.container.clientWidth;\r\n    that.height = that.config.container.clientHeight;\r\n    that.lastTop = 0;\r\n\r\n    that.styleInit();\r\n  }\r\n\r\n  /**\r\n   * 样式初始化\r\n   * @function  styleInit\r\n   * @private\r\n   */\r\n  private styleInit() {\r\n    let that = this;\r\n    // 给弹幕容器加class调用\r\n    that.config.container.className += ' fe-plus-barrage';\r\n\r\n    let oHead: HTMLElement = document.getElementsByTagName('head')[0];\r\n    let oStyle: any = document.createElement('style');\r\n    oStyle.type = 'text/css';\r\n    let sCSS = [\r\n      '.fe-plus-barrage{overflow: hidden}',\r\n      '.fe-plus-barrage .barrage-bullet{position: absolute;left: 100%;top: 0px;z-index: 100;white-space: nowrap;color: #fff;line-height: 160%;text-shadow: 1px 1px 0px rgba(0,0,0,.4);transition: transform 3s linear;}',\r\n      '.fe-plus-barrage .barrage-bullet-notice{font-weight: bold;color:red}',\r\n    ].join('');\r\n    if (oStyle.styleSheet) {\r\n      oStyle.styleSheet.cssText = sCSS;\r\n    } else {\r\n      oStyle.innerHTML = sCSS;\r\n    }\r\n    oHead.appendChild(oStyle);\r\n  }\r\n\r\n  /**\r\n   * 发射弹幕\r\n   * @function emit\r\n   * @param {string} msg \r\n   * @param {EmitConfig} [emitConfig] 拓展样式\r\n   * @param {boolean} [emitConfig.notice] 是否是重点弹幕（加大加粗）\r\n   * @param {string} [emitConfig.fontSize] 字号 “12px”\r\n   * @param {string} [emitConfig.fontColor] 字色“#ff0”\r\n   */\r\n  emit(msg: string, emitConfig?: EmitConfig) {\r\n    const that = this;\r\n    const oEmitConfig: EmitConfig = emitConfig || {};\r\n\r\n    //  获取弹幕子弹元素\r\n    const bullet = new Bullet(msg, oEmitConfig, that.config).get();\r\n\r\n    //  render dom，获取其占位尺寸\r\n    that.config.container.appendChild(bullet);\r\n\r\n    let bulletWidth: number = bullet.clientWidth;\r\n    let bulletHeight: number = bullet.clientHeight;\r\n\r\n    //  top值\r\n    // that.lastTop += bulletHeight + Math.random() * 30;\r\n    that.lastTop += bulletHeight + 0;\r\n    if (that.lastTop + bulletHeight > that.height) {\r\n      that.lastTop = 0;\r\n    }\r\n    bullet.style.top = that.lastTop + 'px';\r\n\r\n    // 移出屏幕偏移量\r\n    let moveX: number = that.width + bulletWidth;\r\n\r\n    //  开始单条弹幕\r\n    bullet.style.transform = 'translate3d(' + -moveX + 'px, 0,0)';\r\n\r\n    //  动画结束消除自己\r\n    function _removeBullet() {\r\n      if (bullet.parentNode) {\r\n        bullet.removeEventListener('webkitTransitionEnd', _removeBullet);\r\n        bullet.removeEventListener('transitionend', _removeBullet);\r\n        bullet.parentNode.removeChild(bullet);\r\n      }\r\n    }\r\n    bullet.addEventListener('webkitTransitionEnd', _removeBullet);\r\n    bullet.addEventListener('transitionend', _removeBullet);\r\n  }\r\n\r\n}\r\n\r\nexport default Barrage;\r\n"]}